(()=>{"use strict";var e={857:e=>{var t=function(e){var t;return!!e&&"object"==typeof e&&"[object RegExp]"!==(t=Object.prototype.toString.call(e))&&"[object Date]"!==t&&e.$$typeof!==r},r="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function n(e,t){return!1!==t.clone&&t.isMergeableObject(e)?a(Array.isArray(e)?[]:{},e,t):e}function l(e,t,r){return e.concat(t).map(function(e){return n(e,r)})}function i(e){return Object.keys(e).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[])}function o(e,t){try{return t in e}catch(e){return!1}}function a(e,r,s){(s=s||{}).arrayMerge=s.arrayMerge||l,s.isMergeableObject=s.isMergeableObject||t,s.cloneUnlessOtherwiseSpecified=n;var c,d,u=Array.isArray(r);return u!==Array.isArray(e)?n(r,s):u?s.arrayMerge(e,r,s):(d={},(c=s).isMergeableObject(e)&&i(e).forEach(function(t){d[t]=n(e[t],c)}),i(r).forEach(function(t){(!o(e,t)||Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))&&(o(e,t)&&c.isMergeableObject(r[t])?d[t]=(function(e,t){if(!t.customMerge)return a;var r=t.customMerge(e);return"function"==typeof r?r:a})(t,c)(e[t],r[t],c):d[t]=n(r[t],c))}),d)}a.all=function(e,t){if(!Array.isArray(e))throw Error("first argument should be an array");return e.reduce(function(e,r){return a(e,r,t)},{})},e.exports=a}},t={};function r(n){var l=t[n];if(void 0!==l)return l.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}(()=>{r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t}})(),(()=>{r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}})(),(()=>{r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e=r(857),t=r.n(e);class n{static ucFirst(e){return e.charAt(0).toUpperCase()+e.slice(1)}static lcFirst(e){return e.charAt(0).toLowerCase()+e.slice(1)}static toDashCase(e){return e.replace(/([A-Z])/g,"-$1").replace(/^-/,"").toLowerCase()}static toLowerCamelCase(e,t){let r=n.toUpperCamelCase(e,t);return n.lcFirst(r)}static toUpperCamelCase(e,t){return t?e.split(t).map(e=>n.ucFirst(e.toLowerCase())).join(""):n.ucFirst(e.toLowerCase())}static parsePrimitive(e){try{return/^\d+(.|,)\d+$/.test(e)&&(e=e.replace(",",".")),JSON.parse(e)}catch(t){return e.toString()}}}class l{static isNode(e){return"object"==typeof e&&null!==e&&(e===document||e===window||e instanceof Node)}static hasAttribute(e,t){if(!l.isNode(e))throw Error("The element must be a valid HTML Node!");return"function"==typeof e.hasAttribute&&e.hasAttribute(t)}static getAttribute(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(r&&!1===l.hasAttribute(e,t))throw Error('The required property "'.concat(t,'" does not exist!'));if("function"!=typeof e.getAttribute){if(r)throw Error("This node doesn't support the getAttribute function!");return}return e.getAttribute(t)}static getDataAttribute(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],i=t.replace(/^data(|-)/,""),o=n.toLowerCamelCase(i,"-");if(!l.isNode(e)){if(r)throw Error("The passed node is not a valid HTML Node!");return}if(void 0===e.dataset){if(r)throw Error("This node doesn't support the dataset attribute!");return}let a=e.dataset[o];if(void 0===a){if(r)throw Error('The required data attribute "'.concat(t,'" does not exist on ').concat(e,"!"));return a}return n.parsePrimitive(a)}static querySelector(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(r&&!l.isNode(e))throw Error("The parent node is not a valid HTML Node!");let n=e.querySelector(t)||!1;if(r&&!1===n)throw Error('The required element "'.concat(t,'" does not exist in parent node!'));return n}static querySelectorAll(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(r&&!l.isNode(e))throw Error("The parent node is not a valid HTML Node!");let n=e.querySelectorAll(t);if(0===n.length&&(n=!1),r&&!1===n)throw Error('At least one item of "'.concat(t,'" must exist in parent node!'));return n}}class i{publish(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=new CustomEvent(e,{detail:t,cancelable:r});return this.el.dispatchEvent(n),n}subscribe(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this,l=e.split("."),i=r.scope?t.bind(r.scope):t;if(r.once&&!0===r.once){let t=i;i=function(r){n.unsubscribe(e),t(r)}}return this.el.addEventListener(l[0],i),this.listeners.push({splitEventName:l,opts:r,cb:i}),!0}unsubscribe(e){let t=e.split(".");return this.listeners=this.listeners.reduce((e,r)=>([...r.splitEventName].sort().toString()===t.sort().toString()?this.el.removeEventListener(r.splitEventName[0],r.cb):e.push(r),e),[]),!0}reset(){return this.listeners.forEach(e=>{this.el.removeEventListener(e.splitEventName[0],e.cb)}),this.listeners=[],!0}get el(){return this._el}set el(e){this._el=e}get listeners(){return this._listeners}set listeners(e){this._listeners=e}constructor(e=document){this._el=e,e.$emitter=this,this._listeners=[]}}class o{init(){throw Error('The "init" method for the plugin "'.concat(this._pluginName,'" is not defined.'))}update(){}_init(){this._initialized||(this.init(),this._initialized=!0)}_update(){this._initialized&&this.update()}_mergeOptions(e){let r=n.toDashCase(this._pluginName),i=l.getDataAttribute(this.el,"data-".concat(r,"-config"),!1),o=l.getAttribute(this.el,"data-".concat(r,"-options"),!1),a=[this.constructor.options,this.options,e];i&&a.push(window.PluginConfigManager.get(this._pluginName,i));try{o&&a.push(JSON.parse(o))}catch(e){throw console.error(this.el),Error('The data attribute "data-'.concat(r,'-options" could not be parsed to json: ').concat(e.message))}return t().all(a.filter(e=>e instanceof Object&&!(e instanceof Array)).map(e=>e||{}))}_registerInstance(){window.PluginManager.getPluginInstancesFromElement(this.el).set(this._pluginName,this),window.PluginManager.getPlugin(this._pluginName,!1).get("instances").push(this)}_getPluginName(e){return e||(e=this.constructor.name),e}constructor(e,t={},r=!1){if(!l.isNode(e))throw Error("There is no valid element given.");this.el=e,this.$emitter=new i(this.el),this._pluginName=this._getPluginName(r),this.options=this._mergeOptions(t),this._initialized=!1,this._registerInstance(),this._init()}}let a=window.PluginManager;a.register("DropdownPlugin",class extends o{init(){window.onload=()=>{this._handlePageReload()},this._initializeDropdowns(),this._updateBuyButtonState()}_handlePageReload(){var e;let t=((e=performance.getEntriesByType("navigation")[0])===null||void 0===e?void 0:e.type)==="reload";console.log("performance",performance),console.log("isPageReload",t),t&&(this._resetCheckboxes(),this._resetUrlParameters()),this._initializeDropdowns(),this._updateBuyButtonState()}_initializeDropdowns(){let e=[...this.el.querySelectorAll(".bundle-dropdown-toggle")];e.length&&(e.forEach(e=>{e.dataset.originalText=e.textContent.trim(),e.addEventListener("click",t=>{t.stopPropagation(),this._toggleDropdown(e)})}),document.addEventListener("click",e=>{e.target.closest(".bundles-select")||this._closeAllDropdowns()}),[...this.el.querySelectorAll(".bundle-checkbox")].forEach(e=>{e.addEventListener("change",e=>{this._updateToggleText(e.target),this._updateBuyButtonState()})}))}_toggleDropdown(e){let t=e.closest(".bundles-select").querySelector(".dropdown-options");t&&(this._closeAllDropdowns(),t.classList.add("is-open"),e.classList.add("is-open"))}_closeAllDropdowns(){let e=this.el.querySelectorAll(".dropdown-options.is-open"),t=this.el.querySelectorAll(".bundle-dropdown-toggle.is-open");e.forEach(e=>e.classList.remove("is-open")),t.forEach(e=>e.classList.remove("is-open"))}_updateToggleText(e){let t=e.closest(".bundles-select"),r=t.querySelector(".bundle-dropdown-toggle");if(!r)return;t.querySelectorAll(".bundle-checkbox").forEach(t=>{t!==e&&(t.checked=!1)});let n=e.checked?e.nextElementSibling.textContent.trim():r.dataset.originalText;r.textContent=n}_updateBuyButtonState(){let e=document.querySelector(".cms-block-gallery-buybox-bundles button.btn-buy"),t=document.getElementById("s25-subscribe-button");if(!e)return;let r=document.querySelectorAll(".bundles-select"),n=!1,l=0,i=0;r.forEach(e=>{let t=e.querySelector(".dropdown-options");if(!t)return;let r=t.querySelectorAll("li"),o=Array.from(t.querySelectorAll(".bundle-checkbox")).filter(e=>{var t;return!e.disabled&&!((t=e.closest("li"))===null||void 0===t?void 0:t.classList.contains("no-quantity-list"))});if(Array.from(r).every(e=>{let t=e.querySelector(".bundle-checkbox");return!t||t.disabled||e.classList.contains("no-quantity-list")})){n=!0;return}o.length>0&&(l++,o.filter(e=>e.checked).length>0&&i++)}),n||0===l||i<l?(e.classList.add("is-disabled"),e.textContent="Please Choose a Bundle",e.style.opacity="0.5",e.style.pointerEvents="none",e.style.cursor="not-allowed",e.disabled=!0,t&&(t.style.opacity="0.5",t.style.pointerEvents="none",t.style.cursor="not-allowed",t.disabled=!0)):(e.classList.remove("is-disabled"),e.textContent="Buy Now",e.style.opacity="1",e.style.pointerEvents="auto",e.style.cursor="pointer",e.disabled=!1,t&&(t.style.opacity="1",t.style.pointerEvents="auto",t.style.cursor="pointer",t.disabled=!1))}_resetUrlParameters(){let e=new URL(window.location.href),t=e.searchParams;t.has("bundles")&&(t.delete("bundles"),window.history.replaceState({},document.title,e.pathname))}_resetCheckboxes(){[...this.el.querySelectorAll(".bundle-checkbox")].forEach(e=>{e.checked=!1;let t=e.closest("li").querySelector("label");t&&(t.classList.remove("checked"),t.classList.remove("is-checked")),e.dispatchEvent(new Event("change"))})}},"[data-dropdown]"),a.register("BundlePriceUpdate",class extends o{init(){console.info(this),this.bundleGroups=document.querySelectorAll(".bundles-select-group .bundle-set"),this.priceDisplay=document.getElementById("bundle-price"),this.selectedOptions=this.parseBundlesQuery(this.bundlesQuery),this.initializeBundleGroups(),this.calculateTotalPrice()}parseBundlesQuery(e){let t={};if(e)try{t=JSON.parse(e)}catch(e){console.error("Error parsing bundlesQuery:",e)}return t}initializeBundleGroups(){this.bundleGroups.forEach(e=>{let t=e.querySelector(".dropdown-options"),r=t.id,n=t.querySelectorAll(".bundle-checkbox"),l=e.querySelector(".bundle-dropdown-toggle");if(l.dataset.originalText=l.textContent.trim(),this.selectedOptions[r]){let e=this.selectedOptions[r].map(e=>e.id);n.forEach(t=>{if(e.includes(t.value)){t.checked=!0;let e=this.findLabelForCheckbox(t);l.textContent=e?e.textContent.trim():l.dataset.originalText}})}this.addCheckboxChangeListener(n,l,t)})}findLabelForCheckbox(e){let t=e.closest("label");return t||e.id&&(t=document.querySelector('label[for="'.concat(e.id,'"]'))),t}addCheckboxChangeListener(e,t,r){e.forEach(n=>{n.addEventListener("change",()=>{n.checked&&e.forEach(e=>{e!==n&&e.getAttribute("data-id")===n.getAttribute("data-id")&&(e.checked=!1)});let l=this.findLabelForCheckbox(n);t.textContent=n.checked&&l?l.textContent.trim():t.dataset.originalText,this.updateSingleBundleParam(r.id),this.calculateTotalPrice()})})}calculateTotalPrice(){let e=parseFloat("{{ grossPrice }}")||0;this.bundleGroups.forEach(t=>{t.querySelectorAll(".bundle-checkbox:checked").forEach(t=>{let r=parseFloat(t.getAttribute("data-price"))||0;e+=r})}),document.querySelectorAll(".calculated-price").forEach(t=>{t.textContent=e.toFixed(2)})}updateSingleBundleParam(e){let t=new URL(window.location.href),r=t.searchParams.get("bundles")?JSON.parse(t.searchParams.get("bundles")):{},n=document.getElementById(e),l=parseFloat(n.getAttribute("data-discount"))||0,i=n.getAttribute("data-discount-type"),o=[];n.querySelectorAll(".bundle-checkbox:checked").forEach(e=>{o.push({id:e.value,price:parseFloat(e.getAttribute("data-price"))||0,discount:l,discountType:i})}),o.length?r[e]=o:delete r[e],t.searchParams.set("bundles",JSON.stringify(r)),window.location.href=t.toString()}},"[data-bundle-price-update]"),a.register("BundlePricePlugin",class extends o{init(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>this._initializePlugin()):this._initializePlugin()}_initializePlugin(){var e,t;this.bundleGroups=document.querySelectorAll(".bundles-select-group .bundle-set"),this.priceDisplay=document.getElementById("bundle-price"),this.subscriptionSinglePriceDisplay=document.getElementById("bundle-subscription-price-single"),this.subscriptionDiscountDisplay=document.getElementById("bundle-subscription-price"),this.subPriceInput=document.getElementById("sub-bundle-price"),this.grossPrice=parseFloat(((e=document.getElementById("bundle-price-container"))===null||void 0===e?void 0:e.dataset.bundlePriceUpdateOptions)||0),this.activeCurrency=this.el.dataset.activeCurrency||"",this.productPriceElement=document.querySelector(".product-detail-price"),this.bundlePriceElement=document.getElementById("bundle-price-display"),this.quantityInput=document.querySelector('.cms-block-gallery-buybox-bundles #quantity-select input[type="number"]'),this.bundlesData={};let r=(t=document.getElementById("bundle-price-container"))===null||void 0===t?void 0:t.dataset.bundlesQuery;if(r&&this._parseBundlesQuery(r),this._registerEvents(),this._interceptAddToCart(),this.calculateTotalPrice(),this.quantityInput){this.quantityInput.addEventListener("input",()=>this.calculateTotalPrice()),this.quantityInput.addEventListener("change",()=>this.calculateTotalPrice());let e=this.quantityInput.closest(".quantity-selector-group");if(e){let t=e.querySelector(".js-btn-minus"),r=e.querySelector(".js-btn-plus");t&&t.addEventListener("click",()=>setTimeout(()=>this.calculateTotalPrice(),0)),r&&r.addEventListener("click",()=>setTimeout(()=>this.calculateTotalPrice(),0))}}}_parseBundlesQuery(e){try{let t=JSON.parse(atob(e));for(let e in t){let r=document.getElementById(e);if(r){let n=r.closest(".bundles-select").querySelector(".bundle-dropdown-toggle");t[e].forEach(e=>{let t=r.querySelector('.bundle-checkbox[value="'.concat(e.id,'"]'));t&&(t.checked=!0,n.textContent=t.nextElementSibling.textContent.trim())})}}this.bundlesData=t}catch(e){console.error("Failed to parse bundle query:",e)}}_registerEvents(){this.bundleGroups.forEach(e=>{let t=e.querySelectorAll(".bundle-checkbox"),r=e.querySelector(".bundle-dropdown-toggle");t.forEach(e=>{e.addEventListener("change",()=>this._onCheckboxChange(e,t,r))})})}_onCheckboxChange(e,t,r){t.forEach(t=>{t!==e&&(t.checked=!1)});let n=e.closest(".dropdown-options"),l=n.id,i=parseFloat(n.dataset.discount||"0"),o=n.dataset.discountType||"none",a=n.dataset.bundleName||"none",s=n.dataset.parentProductId||"none";this.bundlesData[l]=[],t.forEach(e=>{e.checked&&(this.bundlesData[l].push({id:e.value,price:parseFloat(e.dataset.price)||0,bundleQuantity:parseInt(e.dataset.bundleQuantity)||0,bundleName:a,parentProductId:s,discount:i,discountType:o}),r.textContent=e.nextElementSibling.textContent.trim())}),0===this.bundlesData[l].length&&delete this.bundlesData[l],this._updateCookie(),this.calculateTotalPrice()}_updateCookie(){Object.keys(this.bundlesData).length>0?document.cookie="bundleSelection=".concat(JSON.stringify(this.bundlesData),"; path=/; max-age=86400"):document.cookie="bundleSelection=; path=/; max-age=0"}_interceptAddToCart(){let e=document.querySelectorAll('form[action="/checkout/cart"]');e.length&&e.forEach(e=>{e.addEventListener("submit",()=>{let t=localStorage.getItem("bundleSelection");if(!t)return;let r=JSON.parse(t);for(let t in r)r[t].forEach((r,n)=>{let l="lineItems[0][payload][bundles][".concat(t,"][").concat(n,"]");Object.entries({["".concat(l,"[id]")]:r.id,["".concat(l,"[price]")]:r.price,["".concat(l,"[bundleQuantity]")]:r.bundleQuantity,["".concat(l,"[discount]")]:r.discount,["".concat(l,"[discountType]")]:r.discountType}).forEach(t=>{let[r,n]=t,l=document.createElement("input");l.type="hidden",l.name=r,l.value=n,e.appendChild(l)})})})})}updateCheckboxPricesByQuantity(e){document.querySelectorAll(".bundle-checkbox").forEach(t=>{let r=t.value,n=document.querySelector('.price-tiers[data-id="'.concat(r,'"]'));if(!n)return;let l=n.dataset,i=[];for(let e in l){let t=e.match(/^price(\d+)$/);if(t){let r=parseInt(t[1],10),n=parseFloat(l[e]);isNaN(r)||isNaN(n)||i.push({minQty:r,price:n})}}i.sort((e,t)=>e.minQty-t.minQty);let o=parseFloat(t.dataset.price||0);for(let t=0;t<i.length;t++)e>=i[t].minQty&&(o=i[t].price);t.setAttribute("data-price",o.toFixed(2))})}calculateTotalPrice(){let e=1;if(this.quantityInput){let t=parseInt(this.quantityInput.value,10);!isNaN(t)&&t>0&&(e=t)}this.updateCheckboxPricesByQuantity(e);let t=Object.keys(this.bundlesData).length>0,r=0;if(t)for(let t in this.bundlesData)this.bundlesData[t].forEach(t=>{let n=document.querySelector('.bundle-checkbox[value="'.concat(t.id,'"]')),l=n&&n.dataset.price?parseFloat(n.dataset.price):0;"percentage"===t.discountType?l-=l*t.discount/100:"fixed"===t.discountType&&(l-=t.discount),l=Math.max(0,l);let i=t.bundleQuantity||(n?parseInt(n.dataset.bundleQuantity,10):1)||1;r+=l*i*e});else r=this.grossPrice;r<=0&&(r=this.grossPrice);let n="".concat(this.activeCurrency).concat(r.toFixed(2),"*");this.priceDisplay&&(this.priceDisplay.textContent=n),this.subscriptionSinglePriceDisplay&&(this.subscriptionSinglePriceDisplay.textContent=n),this.subPriceInput&&(this.subPriceInput.value=r.toFixed(2)),this.productPriceElement&&this.bundlePriceElement&&(t?(this.bundlePriceElement.style.display="block",this.productPriceElement.style.display="none"):(this.bundlePriceElement.style.display="none",this.productPriceElement.style.display="block"));let l=document.querySelector(".product-detail-list-price-wrapper");l&&(l.style.display=t?"none":"");let i=document.querySelector(".sticky-unit-price");i&&(i.innerHTML='<span>Subtotal:</span> <span class="bundle-subtotal-value">'.concat(n,"</span>"))}},"[data-bundle-price-update-options]"),a.register("GroupedPricePlugin",class extends o{init(){this._setInitialTotalPrice(),this._moveGroupNameToTitle(),this._bindEvents()}_setInitialTotalPrice(){let e=document.querySelector(".total-calculated-price");e&&(e.textContent="$0.00")}_moveGroupNameToTitle(){let e=this.el.querySelector(".fourth-row .group-name"),t=document.querySelector(".title .fourth-row");e&&t&&(t.textContent=e.textContent.trim())}_bindEvents(){document.querySelectorAll(".product-box").forEach(e=>{let t=e.querySelector(".quantity-input"),r=e.querySelector(".price-product"),n=e.querySelector(".calculated-price");t&&r&&n&&(n.textContent="Not Selected",t.addEventListener("input",e=>{this._updateCalculatedPrice(e,r,n),this._calculateSelectedItemsTotal()}))});let e=document.querySelector("#bundle-price-container");e&&e.addEventListener("input",e=>{e.target&&e.target.matches(".quantity-input")&&this._calculateSelectedItemsTotal()})}_updateCalculatedPrice(e,t,r){let n=parseFloat(t.textContent.trim().replace(/[^0-9.]/g,"")),l=parseInt(e.target.value,10)||0,i=parseInt(e.target.max,10)||1/0;if(l>i&&(l=i,e.target.value=i),!isNaN(n)&&l>0){let e=n*l;r.textContent="$".concat(e.toFixed(2))}else r.textContent="$0.00"}_calculateSelectedItemsTotal(){let e=document.querySelector("#bundle-price-container"),t=document.querySelector(".total-calculated-price"),r=0,n=!1;e&&(e.querySelectorAll(".product-box").forEach(e=>{let t=e.querySelector(".price-product"),l=e.querySelector(".quantity-input"),i=e.querySelector(".calculated-price");if(t&&l&&i){let e=parseFloat(t.textContent.trim().replace(/[^0-9.]/g,""))||0,o=parseInt(l.value,10)||0;if(!isNaN(e)&&o>0){let t=e*o;r+=t,i.textContent="$".concat(t.toFixed(2)),n=!0}else i.textContent="$0.00"}}),t&&(t.textContent=n?"$".concat(r.toFixed(2)):"$0.00"))}},"[data-grouped-price-update]"),a.register("stockSwitch",class extends o{init(){let e=document.getElementById("switchInput"),t=document.querySelector(".card-body.no-stock");e&&t&&e.addEventListener("change",()=>{e.checked?t.classList.add("hidde"):t.classList.remove("hidde")})}},"[data-bundle-stock-switch]"),a.register("itemCalc",class extends o{init(){this._setInitialSelectedItemsQuantity(),this.registerEvents()}_setInitialSelectedItemsQuantity(){let e=this.el.querySelector(".selected-items");e&&(e.textContent="0")}registerEvents(){this.el.addEventListener("change",e=>{e.target&&e.target.matches("#quantity-select")&&this.calculateSelectedItemsQuantity()})}calculateSelectedItemsQuantity(){let e=0,t=!1;this.el.querySelectorAll(".product-box").forEach(r=>{let n=r.querySelector("#quantity-select");if(n){let r=parseInt(n.value,10);!isNaN(r)&&r>0&&(e+=r,t=!0)}});let r=this.el.querySelector(".selected-items");r?r.textContent=t?"".concat(e):"0":console.warn("No .selected-items element found")}},"[data-item-calc]"),a.register("addAllCart",class extends o{init(){this.groupedWrapper=document.querySelector(".product-grouped"),this.groupedWrapper&&(this._registerAddAllButtonClick(),this._registerQuantityChange())}_registerAddAllButtonClick(){let e=document.querySelectorAll(".add-all");if(0===e.length){console.warn("[AddAllCart] No add-all buttons found, aborting.");return}e.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();let r=e.closest(".product-grouped");r||console.warn("[AddAllCart] No .product-grouped container found for this button. Using document as fallback.");let n=(r||document).querySelector(".grouped-product-table");if(!n)return;let l=n.querySelectorAll(".product-box");if(0===l.length)return;let i=this._collectAllProductData(l);i.length>0?this._checkCartBeforeAdding(i):alert("Please select at least one product to add.")})})}_registerQuantityChange(){this.groupedWrapper.querySelectorAll("#quantity-select").forEach(e=>{let t=e.querySelector('option[value="0"]');t||((t=document.createElement("option")).value="0",t.textContent="0",e.prepend(t)),e.value="0";let r=e.closest(".product-box"),n=null==r?void 0:r.querySelector('input[name*="[quantity]"]'),l=null==r?void 0:r.querySelector(".calculated-price");n&&(n.value=newQuantity),l&&(l.dataset.originalPrice=l.textContent,l.textContent="$0.00"),e.addEventListener("change",t=>{let r=t.target.value,n=e.closest(".product-box"),l=null==n?void 0:n.querySelector('input[name*="[quantity]"]'),i=null==n?void 0:n.querySelector(".calculated-price");l&&(l.value=r),i&&("0"===r?i.textContent="$0.00":i.textContent=i.dataset.originalPrice||"$0.00"),this._calculateSelectedItemsTotal()})})}_collectAllProductData(e){let t=[];return e.forEach(e=>{let r=e.querySelectorAll('input[type="hidden"]'),n=e.querySelector(".quantity-input");if(!r.length||!n)return;let l=parseInt(n.value,10)||0;if(l<=0)return;let i={};r.forEach(e=>{let t=e.name.match(/lineItems\[(.*?)\]\[(.*?)\]/);if(t){let[,,r]=t;i[r]=e.value}}),i.quantity=l,i.id&&i.referencedId&&"product"===i.type?t.push(i):console.warn("[AddAllCart] Incomplete item data, skipping:",i)}),t}_checkCartBeforeAdding(e){fetch("/bundle/cart-by-customer",{method:"GET",credentials:"include",headers:{Accept:"application/json"}}).then(e=>{if(!e.ok)throw Error("Request failed: ".concat(e.status));return e.json()}).then(t=>{if(!t.success){alert(t.message||"Failed to fetch cart info.");return}let r={};t.lineItems.forEach(e=>{let t=e.referencedId,n=parseInt(e.quantity,10);r[t]=(r[t]||0)+n}),e.forEach(e=>{var t,n;let l=e.referencedId,i=parseInt(e.quantity,10),o=r[l]||0,a=this.groupedWrapper.querySelector('.product-box[data-product-id="'.concat(l,'"]'));if(!a){console.warn("[AddAllCart] No productBox for",l);return}let s=a.querySelector(".stock"),c=((n=null==s?void 0:(t=s.textContent)===null||void 0===t?void 0:t.trim())!==null&&void 0!==n?n:"").match(/\d+/),d=c?parseInt(c[0],10):null;if(null===d){console.warn("[AddAllCart] No valid stock for",l);return}let u=Math.max(d-o,0);s&&(s.textContent="".concat(u));let p=a.querySelector(".quantity-select");if(p){p.innerHTML="";for(let e=0;e<=u;e++){let t=document.createElement("option");t.value=e,t.textContent=e,p.appendChild(t)}let t=Math.min(i,u);p.value=t;let r=a.querySelector('input[name*="[quantity]"]');r&&(r.value=t),e.quantity=t}(u<=0||e.quantity<=0)&&(e.skip=!0)});let n=e.filter(e=>!e.skip&&parseInt(e.quantity,10)>0);if(0===n.length){alert("No valid products to add to the cart.");return}this._submitValidLineItems(n)}).catch(e=>{console.error("[AddAllCart] Error during cart check:",e),alert("Something went wrong while checking your cart. Please try again.")})}_submitValidLineItems(e){let t=document.querySelector(".grouped-product-action .add-all");t&&(t.textContent="Processing...",t.classList.add("is--processing"));let r=new FormData;e.forEach((e,t)=>{Object.entries(e).forEach(e=>{let[n,l]=e;r.append("lineItems[".concat(t,"][").concat(n,"]"),l)})}),r.append("redirectTo","frontend.cart.offcanvas"),r.append("redirectParameters",JSON.stringify({}));let n=document.querySelector('meta[name="csrf-token"]'),l=n?{"X-CSRF-Token":n.getAttribute("content")}:{};fetch("/checkout/line-item/add",{method:"POST",body:r,headers:l}).then(e=>{let t=e.headers.get("Content-Type");return t&&t.includes("application/json")?e.json():e.text()}).then(()=>{let e=document.querySelector(".btn.header-cart-btn.header-actions-btn");e&&(e.click(),t.textContent="Add to shopping cart",t.classList.remove("is--processing"))}).catch(e=>{console.error("Error adding items to cart:",e)})}_registerQuantityChange(){this.groupedWrapper.querySelectorAll(".quantity-input").forEach(e=>{let t=e.closest(".product-box"),r=null==t?void 0:t.querySelector('input[name*="[quantity]"]'),n=null==t?void 0:t.querySelector(".calculated-price");r&&(r.value="0"),n&&(n.dataset.originalPrice=n.textContent,n.textContent="$0.00"),e.addEventListener("input",t=>{let l=parseInt(t.target.value,10)||0,i=parseInt(e.max,10)||1/0;if(l<0&&(l=0),l>i&&(l=i),e.value=l,r&&(r.value=l),n){let e=parseFloat(n.dataset.originalPrice.replace(/[^0-9.,]/g,"").replace(",","."))||0;n.textContent=l>0?"$".concat((e*l).toFixed(2)):"$0.00"}this._calculateSelectedItemsTotal()})})}_calculateSelectedItemsTotal(){let e=0,t=0;this.groupedWrapper.querySelectorAll(".product-box").forEach(r=>{let n=r.querySelector(".quantity-input"),l=r.querySelector(".calculated-price");if(!n||!l)return;let i=parseInt(n.value,10)||0,o=parseFloat(l.dataset.originalPrice.replace(/[^0-9.,]/g,"").replace(",","."))||0;e+=i*o,t+=i});let r=this.groupedWrapper.querySelector(".grouped-total-price");r&&(r.textContent="$".concat(e.toFixed(2)));let n=this.groupedWrapper.querySelector(".selected-items");n&&(n.textContent=t)}},"[data-add-all-cart]"),a.register("StickybuttonPlugin",class extends o{init(){this.hasScrolled=!1,this.productGrouped=document.querySelector(".product-grouped"),this.groupedProductAction=document.querySelector(".grouped-product-action"),this.clone=null,this.productGrouped&&this.groupedProductAction&&(this.observer=new IntersectionObserver(e=>{e.forEach(e=>{!e.isIntersecting&&this.hasScrolled?this.createClone():this.removeClone()})},{threshold:0}),this.observer.observe(this.productGrouped)),this.productListing=document.querySelector(".cms-element-product-listing"),this.addAllButton=document.querySelector(".bundle-add-all"),this.cloneAddAll=null,this.productListing&&this.addAllButton&&(this.listingObserver=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting?this.removeAddAllClone():this.createAddAllClone()})},{threshold:0}),this.listingObserver.observe(this.productListing)),this.registerScrollHandler()}createClone(){if(!this.clone&&this.groupedProductAction){this.clone=this.groupedProductAction.cloneNode(!0),this.clone.classList.add("scrolled-past-clone"),document.body.appendChild(this.clone);let e=this.clone.querySelector(".add-all"),t=this.groupedProductAction.querySelector(".add-all");e&&t&&e.addEventListener("click",e=>{e.preventDefault(),t.click()})}}removeClone(){this.clone&&(this.clone.remove(),this.clone=null)}createAddAllClone(){!this.cloneAddAll&&this.addAllButton&&(this.cloneAddAll=this.addAllButton.cloneNode(!0),this.cloneAddAll.classList.add("bundle-add-all-cloned"),document.body.appendChild(this.cloneAddAll),this.cloneAddAll.addEventListener("click",e=>{e.preventDefault(),this.addAllButton.click()}))}removeAddAllClone(){this.cloneAddAll&&(this.cloneAddAll.remove(),this.cloneAddAll=null)}registerScrollHandler(){window.addEventListener("scroll",()=>{this.hasScrolled=!0;let e=window.scrollY;document.documentElement.scrollHeight-(e+window.innerHeight)<=120?this.createClone():this.removeClone()})}},"[sticky-button]"),a.register("PreventDoubleAddPlugin",class extends o{init(){this._registerEvents()}_registerEvents(){let e=this.el;if(!e)return;let t=!1;e.addEventListener("click",r=>{if(t){r.preventDefault();return}t=!0,e.style.pointerEvents="none",e.style.opacity="0.5",setTimeout(()=>{e.style.pointerEvents="",e.style.opacity="",t=!1},1e3)})}},"[data-prevent-double-add]"),a.register("MaxBundleQuantity",class extends o{init(){this._updateMaxFromSelected(),this.el.addEventListener("change",e=>{e.target.matches(".bundle-checkbox")&&this._updateMaxFromSelected()})}_updateMaxFromSelected(){let e=Array.from(this.el.querySelectorAll('.dropdown-options input[type="checkbox"]:checked')).map(e=>{var t;let r=(t=e.closest("li"))===null||void 0===t?void 0:t.querySelector(".max-quantity");return r?parseInt(r.textContent.trim(),10):NaN}).filter(e=>!isNaN(e));if(0===e.length){this.el.removeAttribute("data-max-quantity");return}let t=Math.min(...e);this.el.dataset.maxQuantity=t,document.querySelectorAll(".quantity-selector-group-input").forEach(e=>{e.setAttribute("max",t);let r=parseInt(e.value,10);!isNaN(r)&&r>t&&(e.value=t)})}},"[data-max-quantity]")})()})();