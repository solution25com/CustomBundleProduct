(()=>{"use strict";var e={857:e=>{var t=function(e){var t;return!!e&&"object"==typeof e&&"[object RegExp]"!==(t=Object.prototype.toString.call(e))&&"[object Date]"!==t&&e.$$typeof!==r},r="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function i(e,t){return!1!==t.clone&&t.isMergeableObject(e)?a(Array.isArray(e)?[]:{},e,t):e}function n(e,t,r){return e.concat(t).map(function(e){return i(e,r)})}function o(e){return Object.keys(e).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[])}function l(e,t){try{return t in e}catch(e){return!1}}function a(e,r,s){(s=s||{}).arrayMerge=s.arrayMerge||n,s.isMergeableObject=s.isMergeableObject||t,s.cloneUnlessOtherwiseSpecified=i;var c,u,d=Array.isArray(r);return d!==Array.isArray(e)?i(r,s):d?s.arrayMerge(e,r,s):(u={},(c=s).isMergeableObject(e)&&o(e).forEach(function(t){u[t]=i(e[t],c)}),o(r).forEach(function(t){(!l(e,t)||Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))&&(l(e,t)&&c.isMergeableObject(r[t])?u[t]=(function(e,t){if(!t.customMerge)return a;var r=t.customMerge(e);return"function"==typeof r?r:a})(t,c)(e[t],r[t],c):u[t]=i(r[t],c))}),u)}a.all=function(e,t){if(!Array.isArray(e))throw Error("first argument should be an array");return e.reduce(function(e,r){return a(e,r,t)},{})},e.exports=a}},t={};function r(i){var n=t[i];if(void 0!==n)return n.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,r),o.exports}(()=>{r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t}})(),(()=>{r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}})(),(()=>{r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e=r(857),t=r.n(e);class i{static ucFirst(e){return e.charAt(0).toUpperCase()+e.slice(1)}static lcFirst(e){return e.charAt(0).toLowerCase()+e.slice(1)}static toDashCase(e){return e.replace(/([A-Z])/g,"-$1").replace(/^-/,"").toLowerCase()}static toLowerCamelCase(e,t){let r=i.toUpperCamelCase(e,t);return i.lcFirst(r)}static toUpperCamelCase(e,t){return t?e.split(t).map(e=>i.ucFirst(e.toLowerCase())).join(""):i.ucFirst(e.toLowerCase())}static parsePrimitive(e){try{return/^\d+(.|,)\d+$/.test(e)&&(e=e.replace(",",".")),JSON.parse(e)}catch(t){return e.toString()}}}class n{static isNode(e){return"object"==typeof e&&null!==e&&(e===document||e===window||e instanceof Node)}static hasAttribute(e,t){if(!n.isNode(e))throw Error("The element must be a valid HTML Node!");return"function"==typeof e.hasAttribute&&e.hasAttribute(t)}static getAttribute(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(r&&!1===n.hasAttribute(e,t))throw Error('The required property "'.concat(t,'" does not exist!'));if("function"!=typeof e.getAttribute){if(r)throw Error("This node doesn't support the getAttribute function!");return}return e.getAttribute(t)}static getDataAttribute(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],o=t.replace(/^data(|-)/,""),l=i.toLowerCamelCase(o,"-");if(!n.isNode(e)){if(r)throw Error("The passed node is not a valid HTML Node!");return}if(void 0===e.dataset){if(r)throw Error("This node doesn't support the dataset attribute!");return}let a=e.dataset[l];if(void 0===a){if(r)throw Error('The required data attribute "'.concat(t,'" does not exist on ').concat(e,"!"));return a}return i.parsePrimitive(a)}static querySelector(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(r&&!n.isNode(e))throw Error("The parent node is not a valid HTML Node!");let i=e.querySelector(t)||!1;if(r&&!1===i)throw Error('The required element "'.concat(t,'" does not exist in parent node!'));return i}static querySelectorAll(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];if(r&&!n.isNode(e))throw Error("The parent node is not a valid HTML Node!");let i=e.querySelectorAll(t);if(0===i.length&&(i=!1),r&&!1===i)throw Error('At least one item of "'.concat(t,'" must exist in parent node!'));return i}}class o{publish(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=new CustomEvent(e,{detail:t,cancelable:r});return this.el.dispatchEvent(i),i}subscribe(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this,n=e.split("."),o=r.scope?t.bind(r.scope):t;if(r.once&&!0===r.once){let t=o;o=function(r){i.unsubscribe(e),t(r)}}return this.el.addEventListener(n[0],o),this.listeners.push({splitEventName:n,opts:r,cb:o}),!0}unsubscribe(e){let t=e.split(".");return this.listeners=this.listeners.reduce((e,r)=>([...r.splitEventName].sort().toString()===t.sort().toString()?this.el.removeEventListener(r.splitEventName[0],r.cb):e.push(r),e),[]),!0}reset(){return this.listeners.forEach(e=>{this.el.removeEventListener(e.splitEventName[0],e.cb)}),this.listeners=[],!0}get el(){return this._el}set el(e){this._el=e}get listeners(){return this._listeners}set listeners(e){this._listeners=e}constructor(e=document){this._el=e,e.$emitter=this,this._listeners=[]}}class l{init(){throw Error('The "init" method for the plugin "'.concat(this._pluginName,'" is not defined.'))}update(){}_init(){this._initialized||(this.init(),this._initialized=!0)}_update(){this._initialized&&this.update()}_mergeOptions(e){let r=i.toDashCase(this._pluginName),o=n.getDataAttribute(this.el,"data-".concat(r,"-config"),!1),l=n.getAttribute(this.el,"data-".concat(r,"-options"),!1),a=[this.constructor.options,this.options,e];o&&a.push(window.PluginConfigManager.get(this._pluginName,o));try{l&&a.push(JSON.parse(l))}catch(e){throw console.error(this.el),Error('The data attribute "data-'.concat(r,'-options" could not be parsed to json: ').concat(e.message))}return t().all(a.filter(e=>e instanceof Object&&!(e instanceof Array)).map(e=>e||{}))}_registerInstance(){window.PluginManager.getPluginInstancesFromElement(this.el).set(this._pluginName,this),window.PluginManager.getPlugin(this._pluginName,!1).get("instances").push(this)}_getPluginName(e){return e||(e=this.constructor.name),e}constructor(e,t={},r=!1){if(!n.isNode(e))throw Error("There is no valid element given.");this.el=e,this.$emitter=new o(this.el),this._pluginName=this._getPluginName(r),this.options=this._mergeOptions(t),this._initialized=!1,this._registerInstance(),this._init()}}let a=window.PluginManager;a.register("DropdownPlugin",class extends l{init(){window.onload=()=>{this._handlePageReload()},this._initializeDropdowns(),this._updateBuyButtonState()}_handlePageReload(){var e;let t=((e=performance.getEntriesByType("navigation")[0])===null||void 0===e?void 0:e.type)==="reload";console.log("performance",performance),console.log("isPageReload",t),t&&(this._resetCheckboxes(),this._resetUrlParameters()),this._initializeDropdowns(),this._updateBuyButtonState()}_initializeDropdowns(){let e=[...this.el.querySelectorAll(".bundle-dropdown-toggle")];e.length&&(e.forEach(e=>{e.dataset.originalText=e.textContent.trim(),e.addEventListener("click",t=>{t.stopPropagation(),this._toggleDropdown(e)})}),document.addEventListener("click",e=>{e.target.closest(".bundles-select")||this._closeAllDropdowns()}),[...this.el.querySelectorAll(".bundle-checkbox")].forEach(e=>{e.addEventListener("change",e=>{this._updateToggleText(e.target),this._updateBuyButtonState()})}))}_toggleDropdown(e){let t=e.closest(".bundles-select").querySelector(".dropdown-options");t&&(this._closeAllDropdowns(),t.classList.add("is-open"),e.classList.add("is-open"))}_closeAllDropdowns(){let e=this.el.querySelectorAll(".dropdown-options.is-open"),t=this.el.querySelectorAll(".bundle-dropdown-toggle.is-open");e.forEach(e=>e.classList.remove("is-open")),t.forEach(e=>e.classList.remove("is-open"))}_updateToggleText(e){let t=e.closest(".bundles-select"),r=t.querySelector(".bundle-dropdown-toggle");if(!r)return;t.querySelectorAll(".bundle-checkbox").forEach(t=>{t!==e&&(t.checked=!1)});let i=e.checked?e.nextElementSibling.textContent.trim():r.dataset.originalText;r.textContent=i}_updateBuyButtonState(){let e=document.querySelector(".cms-block-gallery-buybox-bundles button.btn-buy"),t=document.getElementById("s25-subscribe-button");if(!e)return;let r=document.querySelectorAll(".bundles-select"),i=!1,n=0,o=0;r.forEach(e=>{let t=e.querySelector(".dropdown-options");if(!t)return;let r=t.querySelectorAll("li"),l=Array.from(t.querySelectorAll(".bundle-checkbox")).filter(e=>{var t;return!e.disabled&&!((t=e.closest("li"))===null||void 0===t?void 0:t.classList.contains("no-quantity-list"))});if(Array.from(r).every(e=>{let t=e.querySelector(".bundle-checkbox");return!t||t.disabled||e.classList.contains("no-quantity-list")})){i=!0;return}l.length>0&&(n++,l.filter(e=>e.checked).length>0&&o++)}),i||0===n||o<n?(e.classList.add("is-disabled"),e.textContent="Please Choose a Bundle",e.style.opacity="0.5",e.style.pointerEvents="none",e.style.cursor="not-allowed",e.disabled=!0,t&&(t.style.opacity="0.5",t.style.pointerEvents="none",t.style.cursor="not-allowed",t.disabled=!0)):(e.classList.remove("is-disabled"),e.textContent="Buy Now",e.style.opacity="1",e.style.pointerEvents="auto",e.style.cursor="pointer",e.disabled=!1,t&&(t.style.opacity="1",t.style.pointerEvents="auto",t.style.cursor="pointer",t.disabled=!1))}_resetUrlParameters(){let e=new URL(window.location.href),t=e.searchParams;t.has("bundles")&&(t.delete("bundles"),window.history.replaceState({},document.title,e.pathname))}_resetCheckboxes(){[...this.el.querySelectorAll(".bundle-checkbox")].forEach(e=>{e.checked=!1;let t=e.closest("li").querySelector("label");t&&(t.classList.remove("checked"),t.classList.remove("is-checked")),e.dispatchEvent(new Event("change"))})}},"[data-dropdown]"),a.register("BundlePriceUpdate",class extends l{init(){console.info(this),this.bundleGroups=document.querySelectorAll(".bundles-select-group .bundle-set"),this.priceDisplay=document.getElementById("bundle-price"),this.selectedOptions=this.parseBundlesQuery(this.bundlesQuery),this.initializeBundleGroups(),this.calculateTotalPrice()}parseBundlesQuery(e){let t={};if(e)try{t=JSON.parse(e)}catch(e){console.error("Error parsing bundlesQuery:",e)}return t}initializeBundleGroups(){this.bundleGroups.forEach(e=>{let t=e.querySelector(".dropdown-options"),r=t.id,i=t.querySelectorAll(".bundle-checkbox"),n=e.querySelector(".bundle-dropdown-toggle");if(n.dataset.originalText=n.textContent.trim(),this.selectedOptions[r]){let e=this.selectedOptions[r].map(e=>e.id);i.forEach(t=>{if(e.includes(t.value)){t.checked=!0;let e=this.findLabelForCheckbox(t);n.textContent=e?e.textContent.trim():n.dataset.originalText}})}this.addCheckboxChangeListener(i,n,t)})}findLabelForCheckbox(e){let t=e.closest("label");return t||e.id&&(t=document.querySelector('label[for="'.concat(e.id,'"]'))),t}addCheckboxChangeListener(e,t,r){e.forEach(i=>{i.addEventListener("change",()=>{i.checked&&e.forEach(e=>{e!==i&&e.getAttribute("data-id")===i.getAttribute("data-id")&&(e.checked=!1)});let n=this.findLabelForCheckbox(i);t.textContent=i.checked&&n?n.textContent.trim():t.dataset.originalText,this.updateSingleBundleParam(r.id),this.calculateTotalPrice()})})}calculateTotalPrice(){let e=parseFloat("{{ grossPrice }}")||0;this.bundleGroups.forEach(t=>{t.querySelectorAll(".bundle-checkbox:checked").forEach(t=>{let r=parseFloat(t.getAttribute("data-price"))||0;e+=r})}),document.querySelectorAll(".calculated-price").forEach(t=>{t.textContent=e.toFixed(2)})}updateSingleBundleParam(e){let t=new URL(window.location.href),r=t.searchParams.get("bundles")?JSON.parse(t.searchParams.get("bundles")):{},i=document.getElementById(e),n=parseFloat(i.getAttribute("data-discount"))||0,o=i.getAttribute("data-discount-type"),l=[];i.querySelectorAll(".bundle-checkbox:checked").forEach(e=>{l.push({id:e.value,price:parseFloat(e.getAttribute("data-price"))||0,discount:n,discountType:o})}),l.length?r[e]=l:delete r[e],t.searchParams.set("bundles",JSON.stringify(r)),window.location.href=t.toString()}},"[data-bundle-price-update]"),a.register("BundlePricePlugin",class extends l{init(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>this._initializePlugin()):this._initializePlugin()}_initializePlugin(){var e,t;this.bundleGroups=document.querySelectorAll(".bundles-select-group .bundle-set"),this.priceDisplay=document.getElementById("bundle-price"),this.subscriptionSinglePriceDisplay=document.getElementById("bundle-subscription-price-single"),this.subscriptionDiscountDisplay=document.getElementById("bundle-subscription-price"),this.subPriceInput=document.getElementById("sub-bundle-price"),this.grossPrice=parseFloat(((e=document.getElementById("bundle-price-container"))===null||void 0===e?void 0:e.dataset.bundlePriceUpdateOptions)||0),this.activeCurrency=this.el.dataset.activeCurrency||"",this.productPriceElement=document.querySelector(".product-detail-price"),this.bundlePriceElement=document.getElementById("bundle-price-display"),this.quantityInput=document.querySelector('.cms-block-gallery-buybox-bundles #quantity-select input[type="number"]'),this.bundlesData={};let r=(t=document.getElementById("bundle-price-container"))===null||void 0===t?void 0:t.dataset.bundlesQuery;if(r&&this._parseBundlesQuery(r),this._registerEvents(),this._interceptAddToCart(),this.calculateTotalPrice(),this.quantityInput){this.quantityInput.addEventListener("input",()=>this.calculateTotalPrice()),this.quantityInput.addEventListener("change",()=>this.calculateTotalPrice());let e=this.quantityInput.closest(".quantity-selector-group");if(e){let t=e.querySelector(".js-btn-minus"),r=e.querySelector(".js-btn-plus");t&&t.addEventListener("click",()=>setTimeout(()=>this.calculateTotalPrice(),0)),r&&r.addEventListener("click",()=>setTimeout(()=>this.calculateTotalPrice(),0))}}}_parseBundlesQuery(e){try{let t=JSON.parse(atob(e));for(let e in t){let r=document.getElementById(e);if(r){let i=r.closest(".bundles-select").querySelector(".bundle-dropdown-toggle");t[e].forEach(e=>{let t=r.querySelector('.bundle-checkbox[value="'.concat(e.id,'"]'));t&&(t.checked=!0,i.textContent=t.nextElementSibling.textContent.trim())})}}this.bundlesData=t}catch(e){console.error("Failed to parse bundle query:",e)}}_registerEvents(){this.bundleGroups.forEach(e=>{let t=e.querySelectorAll(".bundle-checkbox"),r=e.querySelector(".bundle-dropdown-toggle");t.forEach(e=>{e.addEventListener("change",()=>this._onCheckboxChange(e,t,r))})})}_onCheckboxChange(e,t,r){t.forEach(t=>{t!==e&&(t.checked=!1)});let i=e.closest(".dropdown-options"),n=i.id,o=parseFloat(i.dataset.discount||"0"),l=i.dataset.discountType||"none",a=i.dataset.bundleName||"none",s=i.dataset.parentProductId||"none";this.bundlesData[n]=[],t.forEach(e=>{e.checked&&(this.bundlesData[n].push({id:e.value,price:parseFloat(e.dataset.price)||0,bundleQuantity:parseInt(e.dataset.bundleQuantity)||0,bundleName:a,parentProductId:s,discount:o,discountType:l}),r.textContent=e.nextElementSibling.textContent.trim())}),0===this.bundlesData[n].length&&delete this.bundlesData[n],this._updateCookie(),this.calculateTotalPrice()}_updateCookie(){Object.keys(this.bundlesData).length>0?document.cookie="bundleSelection=".concat(JSON.stringify(this.bundlesData),"; path=/; max-age=86400"):document.cookie="bundleSelection=; path=/; max-age=0"}_interceptAddToCart(){let e=document.querySelectorAll('form[action="/checkout/cart"]');e.length&&e.forEach(e=>{e.addEventListener("submit",()=>{let t=localStorage.getItem("bundleSelection");if(!t)return;let r=JSON.parse(t);for(let t in r)r[t].forEach((r,i)=>{let n="lineItems[0][payload][bundles][".concat(t,"][").concat(i,"]");Object.entries({["".concat(n,"[id]")]:r.id,["".concat(n,"[price]")]:r.price,["".concat(n,"[bundleQuantity]")]:r.bundleQuantity,["".concat(n,"[discount]")]:r.discount,["".concat(n,"[discountType]")]:r.discountType}).forEach(t=>{let[r,i]=t,n=document.createElement("input");n.type="hidden",n.name=r,n.value=i,e.appendChild(n)})})})})}updateCheckboxPricesByQuantity(e){document.querySelectorAll(".bundle-checkbox").forEach(t=>{let r=t.value,i=document.querySelector('.price-tiers[data-id="'.concat(r,'"]'));if(!i)return;let n=i.dataset,o=[];for(let e in n){let t=e.match(/^price(\d+)$/);if(t){let r=parseInt(t[1],10),i=parseFloat(n[e]);isNaN(r)||isNaN(i)||o.push({minQty:r,price:i})}}o.sort((e,t)=>e.minQty-t.minQty);let l=parseFloat(t.dataset.price||0);for(let t=0;t<o.length;t++)e>=o[t].minQty&&(l=o[t].price);t.setAttribute("data-price",l.toFixed(2))})}calculateTotalPrice(){let e=1;if(this.quantityInput){let t=parseInt(this.quantityInput.value,10);!isNaN(t)&&t>0&&(e=t)}this.updateCheckboxPricesByQuantity(e);let t=Object.keys(this.bundlesData).length>0,r=0;if(t)for(let t in this.bundlesData)this.bundlesData[t].forEach(t=>{let i=document.querySelector('.bundle-checkbox[value="'.concat(t.id,'"]')),n=i&&i.dataset.price?parseFloat(i.dataset.price):0;"percentage"===t.discountType?n-=n*t.discount/100:"fixed"===t.discountType&&(n-=t.discount),n=Math.max(0,n);let o=t.bundleQuantity||(i?parseInt(i.dataset.bundleQuantity,10):1)||1;r+=n*o*e});else r=this.grossPrice;r<=0&&(r=this.grossPrice);let i="".concat(this.activeCurrency).concat(r.toFixed(2),"*");this.priceDisplay&&(this.priceDisplay.textContent=i),this.subscriptionSinglePriceDisplay&&(this.subscriptionSinglePriceDisplay.textContent=i),this.subPriceInput&&(this.subPriceInput.value=r.toFixed(2)),this.productPriceElement&&this.bundlePriceElement&&(t?(this.bundlePriceElement.style.display="block",this.productPriceElement.style.display="none"):(this.bundlePriceElement.style.display="none",this.productPriceElement.style.display="block"));let n=document.querySelector(".product-detail-list-price-wrapper");n&&(n.style.display=t?"none":"");let o=document.querySelector(".sticky-unit-price");o&&(o.innerHTML='<span>Subtotal:</span> <span class="bundle-subtotal-value">'.concat(i,"</span>"))}},"[data-bundle-price-update-options]"),a.register("GroupedPricePlugin",class extends l{init(){this._setInitialTotalPrice(),this._moveGroupNameToTitle(),this._bindEvents()}_setInitialTotalPrice(){let e=document.querySelector(".total-calculated-price");e&&(e.textContent="$0.00")}_moveGroupNameToTitle(){let e=this.el.querySelector(".fourth-row .group-name"),t=document.querySelector(".title .fourth-row");e&&t&&(t.textContent=e.textContent.trim())}_bindEvents(){document.querySelectorAll(".product-box").forEach(e=>{let t=e.querySelector(".quantity-input"),r=e.querySelector(".price-product"),i=e.querySelector(".calculated-price");t&&r&&i&&(i.textContent="Not Selected",t.addEventListener("input",e=>{this._updateCalculatedPrice(e,r,i),this._calculateSelectedItemsTotal()}))});let e=document.querySelector("#bundle-price-container");e&&e.addEventListener("input",e=>{e.target&&e.target.matches(".quantity-input")&&this._calculateSelectedItemsTotal()})}_updateCalculatedPrice(e,t,r){let i=parseFloat(t.textContent.trim().replace(/[^0-9.]/g,"")),n=parseInt(e.target.value,10)||0,o=parseInt(e.target.max,10)||1/0;if(n>o&&(n=o,e.target.value=o),!isNaN(i)&&n>0){let e=i*n;r.textContent="$".concat(e.toFixed(2))}else r.textContent="$0.00"}_calculateSelectedItemsTotal(){let e=document.querySelector("#bundle-price-container"),t=document.querySelector(".total-calculated-price"),r=0,i=!1;e&&(e.querySelectorAll(".product-box").forEach(e=>{let t=e.querySelector(".price-product"),n=e.querySelector(".quantity-input"),o=e.querySelector(".calculated-price");if(t&&n&&o){let e=parseFloat(t.textContent.trim().replace(/[^0-9.]/g,""))||0,l=parseInt(n.value,10)||0;if(!isNaN(e)&&l>0){let t=e*l;r+=t,o.textContent="$".concat(t.toFixed(2)),i=!0}else o.textContent="$0.00"}}),t&&(t.textContent=i?"$".concat(r.toFixed(2)):"$0.00"))}},"[data-grouped-price-update]"),a.register("stockSwitch",class extends l{init(){let e=document.getElementById("switchInput"),t=document.querySelector(".card-body.no-stock");e&&t&&e.addEventListener("change",()=>{e.checked?t.classList.add("hidde"):t.classList.remove("hidde")})}},"[data-bundle-stock-switch]"),a.register("itemCalc",class extends l{init(){this._setInitialSelectedItemsQuantity(),this.registerEvents()}_setInitialSelectedItemsQuantity(){let e=this.el.querySelector(".selected-items");e&&(e.textContent="0")}registerEvents(){this.el.addEventListener("change",e=>{e.target&&e.target.matches("#quantity-select")&&this.calculateSelectedItemsQuantity()})}calculateSelectedItemsQuantity(){let e=0,t=!1;this.el.querySelectorAll(".product-box").forEach(r=>{let i=r.querySelector("#quantity-select");if(i){let r=parseInt(i.value,10);!isNaN(r)&&r>0&&(e+=r,t=!0)}});let r=this.el.querySelector(".selected-items");r?r.textContent=t?"".concat(e):"0":console.warn("No .selected-items element found")}},"[data-item-calc]"),a.register("addAllCart",class extends l{init(){this.groupedWrapper=document.querySelector(".product-grouped"),this.groupedWrapper&&(this._registerAddAllButtonClick(),this._registerQuantityChange())}_registerAddAllButtonClick(){let e=document.querySelectorAll(".add-all");if(0===e.length){console.warn("[AddAllCart] No add-all buttons found, aborting.");return}e.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();let r=e.closest(".product-grouped");r||console.warn("[AddAllCart] No .product-grouped container found for this button. Using document as fallback.");let i=(r||document).querySelector(".grouped-product-table");if(!i)return;let n=i.querySelectorAll(".product-box");if(0===n.length)return;let o=this._collectAllProductData(n);o.length>0?this._checkCartBeforeAdding(o):alert("Please select at least one product to add.")})})}_registerQuantityChange(){this.groupedWrapper.querySelectorAll("#quantity-select").forEach(e=>{let t=e.querySelector('option[value="0"]');t||((t=document.createElement("option")).value="0",t.textContent="0",e.prepend(t)),e.value="0";let r=e.closest(".product-box"),i=null==r?void 0:r.querySelector('input[name*="[quantity]"]'),n=null==r?void 0:r.querySelector(".calculated-price");i&&(i.value=newQuantity),n&&(n.dataset.originalPrice=n.textContent,n.textContent="$0.00"),e.addEventListener("change",t=>{let r=t.target.value,i=e.closest(".product-box"),n=null==i?void 0:i.querySelector('input[name*="[quantity]"]'),o=null==i?void 0:i.querySelector(".calculated-price");n&&(n.value=r),o&&("0"===r?o.textContent="$0.00":o.textContent=o.dataset.originalPrice||"$0.00"),this._calculateSelectedItemsTotal()})})}_collectAllProductData(e){let t=[];return e.forEach(e=>{let r=e.querySelectorAll('input[type="hidden"]'),i=e.querySelector(".quantity-input");if(!r.length||!i)return;let n=parseInt(i.value,10)||0;if(n<=0)return;let o={};r.forEach(e=>{let t=e.name.match(/lineItems\[(.*?)\]\[(.*?)\]/);if(t){let[,,r]=t;o[r]=e.value}}),o.quantity=n,o.id&&o.referencedId&&"product"===o.type?t.push(o):console.warn("[AddAllCart] Incomplete item data, skipping:",o)}),t}_checkCartBeforeAdding(e){fetch("/bundle/cart-by-customer",{method:"GET",credentials:"include",headers:{Accept:"application/json"}}).then(e=>{if(!e.ok)throw Error("Request failed: ".concat(e.status));return e.json()}).then(t=>{if(!t.success){this._showFullStockPopup(e);return}let r={};t.lineItems.forEach(e=>{let t=e.referencedId,i=parseInt(e.quantity,10);r[t]=(r[t]||0)+i}),this.lastKnownCartQuantities=r,e.forEach(e=>{var t,i,n,o;let l=e.referencedId,a=parseInt(e.quantity,10),s=r[l]||0,c=this.groupedWrapper.querySelector('.product-box[data-product-id="'.concat(l,'"]'));if(!c)return;let u=c.querySelector(".stock"),d=((i=null==u?void 0:(t=u.textContent)===null||void 0===t?void 0:t.trim())!==null&&void 0!==i?i:"").match(/\d+/),p=d?parseInt(d[0],10):null;if(null===p)return;let h=Math.max(p-s,0);u&&(u.textContent="".concat(h));let y=c.querySelector(".quantity-input"),g=c.querySelector(".sixth-row"),m=null==g?void 0:g.querySelector(".cart-info-message");if(m&&m.remove(),s>=p){y&&y.remove();let t=document.createElement("span");t.classList.add("cart-info-message"),t.textContent="Already added in cart",g&&g.appendChild(t);let r=(null==c?void 0:(o=c.querySelector(".product-name"))===null||void 0===o?void 0:(n=o.textContent)===null||void 0===n?void 0:n.trim())||"Product";this._showHtmlAlert("".concat(r," is already added in cart with max stock.")),e.skip=!0;return}if(y){y.disabled=!1,y.max=h,y.min=0,y.value=Math.min(a,h);let t=c.querySelector('input[name*="[quantity]"]');t&&(t.value=y.value),e.quantity=parseInt(y.value,10)}(h<=0||e.quantity<=0)&&(e.skip=!0)});let i=e.filter(e=>!e.skip&&parseInt(e.quantity,10)>0);if(0===i.length){this._showFullStockPopup(e,r);return}this._submitValidLineItems(i)}).catch(t=>{console.error("[AddAllCart] Error during cart check:",t),this.lastKnownCartQuantities&&e.find(e=>{var t,r;let i=e.referencedId,n=this.groupedWrapper.querySelector('.product-box[data-product-id="'.concat(i,'"]')),o=null==n?void 0:n.querySelector(".stock"),l=((r=null==o?void 0:(t=o.textContent)===null||void 0===t?void 0:t.trim())!==null&&void 0!==r?r:"").match(/\d+/),a=l?parseInt(l[0],10):null,s=this.lastKnownCartQuantities[i]||0;return null!==a&&s>=a})})}_showHtmlAlert(e){if(!this.groupedWrapper)return;let t=this.groupedWrapper.querySelector("#custom-alert-container");t||((t=document.createElement("div")).id="custom-alert-container",t.style.position="relative",this.groupedWrapper.appendChild(t));let r=document.createElement("div");r.classList.add("custom-alert"),r.textContent=e,t.appendChild(r),requestAnimationFrame(()=>{r.style.left="20px"}),setTimeout(()=>{r.style.left="-300px",setTimeout(()=>r.remove(),500)},3e3)}_submitValidLineItems(e){let t=document.querySelectorAll(".add-all");t&&t.length>0&&t.forEach(e=>{e.textContent="Processing...",e.classList.add("is--processing"),e.setAttribute("disabled","true")});let r=new FormData;e.forEach((e,t)=>{Object.entries(e).forEach(e=>{let[i,n]=e;r.append("lineItems[".concat(t,"][").concat(i,"]"),n)})}),r.append("redirectTo","frontend.cart.offcanvas"),r.append("redirectParameters",JSON.stringify({}));let i=document.querySelector('meta[name="csrf-token"]'),n=i?{"X-CSRF-Token":i.getAttribute("content")}:{};fetch("/checkout/line-item/add",{method:"POST",body:r,headers:n}).then(e=>{let t=e.headers.get("Content-Type");return t&&t.includes("application/json")?e.json():e.text()}).then(()=>{let e=document.querySelector(".btn.header-cart-btn.header-actions-btn");e&&e.click(),t&&t.length>0&&t.forEach(e=>{e.textContent="Add to shopping cart",e.classList.remove("is--processing"),e.removeAttribute("disabled")})}).catch(e=>{console.error("Error adding items to cart:",e)})}_registerQuantityChange(){this.groupedWrapper.querySelectorAll(".quantity-input").forEach(e=>{let t=e.closest(".product-box"),r=null==t?void 0:t.querySelector('input[name*="[quantity]"]'),i=null==t?void 0:t.querySelector(".calculated-price");r&&(r.value="0"),i&&(i.dataset.originalPrice=i.textContent,i.textContent="$0.00"),e.addEventListener("input",t=>{let n=parseInt(t.target.value,10)||0,o=parseInt(e.max,10)||1/0;if(n<0&&(n=0),n>o&&(n=o),e.value=n,r&&(r.value=n),i){let e=parseFloat(i.dataset.originalPrice.replace(/[^0-9.,]/g,"").replace(",","."))||0;i.textContent=n>0?"$".concat((e*n).toFixed(2)):"$0.00"}this._calculateSelectedItemsTotal()})})}_calculateSelectedItemsTotal(){let e=0,t=0;this.groupedWrapper.querySelectorAll(".product-box").forEach(r=>{let i=r.querySelector(".quantity-input"),n=r.querySelector(".calculated-price");if(!i||!n)return;let o=parseInt(i.value,10)||0,l=parseFloat(n.dataset.originalPrice.replace(/[^0-9.,]/g,"").replace(",","."))||0;e+=o*l,t+=o});let r=this.groupedWrapper.querySelector(".grouped-total-price");r&&(r.textContent="$".concat(e.toFixed(2)));let i=this.groupedWrapper.querySelector(".selected-items");i&&(i.textContent=t)}},"[data-add-all-cart]"),a.register("StickybuttonPlugin",class extends l{init(){this.groupedProductAction=document.querySelector(".grouped-product-action"),this.clone=null,this.quantityChanged=!1,this.container=document.querySelector("#bundle-price-container"),this.groupedProductAction&&(this.registerScrollHandler(),this.registerGlobalClickHandler(),this.registerInputHandler())}createClone(){this.removeClone(),this.groupedProductAction&&(this.clone=this.groupedProductAction.cloneNode(!0),this.clone.classList.add("scrolled-past-clone"),this.clone.removeAttribute("data-add-all-cart"),this.clone.removeAttribute("data-sticky-grouped-product"),document.body.appendChild(this.clone))}removeClone(){this.clone&&(this.clone.remove(),this.clone=null)}registerScrollHandler(){window.addEventListener("scroll",()=>{if(this._isInViewport(this.groupedProductAction)){this.removeClone();return}this.groupedProductAction.getBoundingClientRect().top<150||this.quantityChanged?this.createClone():this.removeClone()},{passive:!0})}registerInputHandler(){this.container&&this.container.addEventListener("input",e=>{e.target.matches('.sixth-row input[type="number"]')&&!this._isInViewport(this.groupedProductAction)&&(this.quantityChanged=!0,this.createClone())})}registerGlobalClickHandler(){document.addEventListener("click",e=>{if(e.target.closest(".scrolled-past-clone .add-all")){e.preventDefault();let t=document.querySelector(".product-grouped .grouped-product-action .add-all");t&&t.click()}})}_isInViewport(e){let t=e.getBoundingClientRect();return t.top<window.innerHeight&&t.bottom>0}},"[sticky-button]"),a.register("PreventDoubleAddPlugin",class extends l{init(){this._registerEvents()}_registerEvents(){let e=this.el;if(!e)return;let t=!1;e.addEventListener("click",r=>{if(t){r.preventDefault();return}t=!0,e.style.pointerEvents="none",e.style.opacity="0.5",setTimeout(()=>{e.style.pointerEvents="",e.style.opacity="",t=!1},1e3)})}},"[data-prevent-double-add]"),a.register("MaxBundleQuantity",class extends l{init(){this._updateMaxFromSelected(),this.el.addEventListener("change",e=>{e.target.matches(".bundle-checkbox")&&this._updateMaxFromSelected()})}_updateMaxFromSelected(){let e=Array.from(this.el.querySelectorAll('.dropdown-options input[type="checkbox"]:checked')).map(e=>{var t;let r=(t=e.closest("li"))===null||void 0===t?void 0:t.querySelector(".max-quantity");return r?parseInt(r.textContent.trim(),10):NaN}).filter(e=>!isNaN(e));if(0===e.length){this.el.removeAttribute("data-max-quantity");return}let t=Math.min(...e);this.el.dataset.maxQuantity=t,document.querySelectorAll(".quantity-selector-group-input").forEach(e=>{e.setAttribute("max",t);let r=parseInt(e.value,10);!isNaN(r)&&r>t&&(e.value=t)})}},"[data-max-quantity]"),a.register("StickyGroupedProductActionPlugin",class extends l{init(){if(this.container=document.querySelector("#bundle-price-container"),this.originalAction=document.querySelector(".grouped-product-action"),!this.container||!this.originalAction){console.warn("Elementët e nevojshëm nuk u gjetën.");return}this.stickyActive=!1,this.lastScrollY=window.scrollY,this.quantityChanged=!1,this._registerEvents()}_registerEvents(){window.addEventListener("scroll",this._onScroll.bind(this)),this.container.addEventListener("input",this._onInput.bind(this))}_onScroll(){let e=window.scrollY,t=e<this.lastScrollY;this._isInViewport(this.originalAction)&&this._removeSticky(),this.quantityChanged&&t&&!this._isInViewport(this.originalAction)&&!this.stickyActive&&this._showSticky(),this.lastScrollY=e}_onInput(e){e.target.matches('.sixth-row input[type="number"]')&&!this._isInViewport(this.originalAction)&&(console.log("U ndryshua quantity:",e.target.value),this.quantityChanged=!0,this._showSticky())}_isInViewport(e){let t=e.getBoundingClientRect();return t.top<window.innerHeight&&t.bottom>0}_showSticky(){this._removeSticky();let e=this.originalAction.cloneNode(!0);e.classList.add("sticky-clone"),Array.from(e.attributes).forEach(t=>{t.name.startsWith("data-")&&e.removeAttribute(t.name)}),Object.assign(e.style,{position:"fixed",bottom:"0",left:"0",right:"0",zIndex:"10"}),document.body.appendChild(e),this.stickyActive=!0;let t=e.querySelector(".product-grouped .add-all")||e.querySelector(".add-all"),r=this.originalAction.querySelector(".product-grouped .add-all")||this.originalAction.querySelector(".add-all");t&&r&&t.addEventListener("click",e=>{e.preventDefault(),r.click()})}_removeSticky(){let e=document.querySelector(".grouped-product-action.sticky-clone");e&&e.remove(),this.stickyActive=!1}},"[data-sticky-grouped-product]"),a.register("QuantityTooltipPlugin",class extends l{init(){this.quantityInputs=this.el.querySelectorAll(".quantity-input"),this.quantityInputs.forEach(e=>{let t=parseInt(e.getAttribute("max")),r=parseInt(e.getAttribute("min"))||0;e.addEventListener("focus",()=>{let i=parseInt(e.value)||0;this.clearTooltip(e),i>=t?this.setTooltip(e,"LIMIT: ".concat(t," Per Day")):i<r&&r>1&&this.setTooltip(e,"Min Order QTY ".concat(r))}),e.addEventListener("input",()=>this.clearTooltip(e)),e.addEventListener("blur",()=>this.clearTooltip(e))})}setTooltip(e,t){e.setAttribute("data-bs-title",t),e.setAttribute("data-bs-toggle","tooltip"),e.setAttribute("data-bs-placement","bottom"),e.setAttribute("data-bs-custom-class","custom-tooltip"),new bootstrap.Tooltip(e).show()}clearTooltip(e){let t=bootstrap.Tooltip.getInstance(e);t&&t.dispose(),e.removeAttribute("data-bs-title"),e.removeAttribute("data-bs-toggle"),e.removeAttribute("data-bs-placement"),e.removeAttribute("data-bs-custom-class")}},"[data-quantity-tooltip]")})()})();